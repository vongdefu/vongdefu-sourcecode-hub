# æ„å»º VitePress ç«™ç‚¹å¹¶å°†å…¶éƒ¨ç½²åˆ° GitHub Pages çš„ç¤ºä¾‹å·¥ä½œæµç¨‹
#
name: Deploy VitePress site to Pages

on:
  # åœ¨é’ˆå¯¹ `main` åˆ†æ”¯çš„æ¨é€ä¸Šè¿è¡Œã€‚å¦‚æœä½ 
  # ä½¿ç”¨ `master` åˆ†æ”¯ä½œä¸ºé»˜è®¤åˆ†æ”¯ï¼Œè¯·å°†å…¶æ›´æ”¹ä¸º `master`
  push:
    branches: [master]
    paths:
      - "docs/**"

jobs:
  ci:
    runs-on: ubuntu-latest
    permissions:
      contents: write # To push a branch
      pages: write # To push to a GitHub Pages site
      id-token: write # To update the deployment status
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: ğŸŒ å…‹éš†å…¬æœ‰ä»“åº“ vongdefu.github.io åˆ°è™šæ‹Ÿæœº
        run: |
          git clone https://x-access-token:${{ secrets.PAT_TOKEN }}@github.com/vongdefu/vongdefu.github.io.git vongdefu.github.io

      - name: ğŸ’ æŠŠ docs ç›®å½•ä¸‹çš„mdæ–‡æ¡£å¤åˆ¶åˆ° vongdefu.github.io åº“ï¼Œå¹¶æ¨é€åˆ°è¿œç«¯
        run: |
          rsync -av --delete docs/ vongdefu.github.io/docs/
          cd vongdefu.github.io
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add .
          git commit -m "${{ github.event.head_commit.message }}, ${{ github.sha }}"
          git push origin master
